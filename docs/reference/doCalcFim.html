<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Calculate Fisher Information Matrix — doCalcFim • parid</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate Fisher Information Matrix — doCalcFim"><meta property="og:description" content="This is the workhorse for all FIM calculation methods.
The difference with calcFimFromMatrix is that it does not check the validity of the
variance-covariance matrices, and assumes that they are in the appropriate format.
It calculates the Fisher Information Matrix (FIM) from the given variational matrix,
that is, calculates minus the expectation of the second order derivative matrix of the log-likelihood
at the given times with respect to the model parameters.
The times are given in the variational matrix, which contains first and second order derivatives of
the output with respect to certain parameters, at certain times, for a particular individual."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">parid</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/parid.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate Fisher Information Matrix</h1>
    
    <div class="hidden name"><code>doCalcFim.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This is the workhorse for all FIM calculation methods.
The difference with <code>calcFimFromMatrix</code> is that it does not check the validity of the
variance-covariance matrices, and assumes that they are in the appropriate format.
It calculates the Fisher Information Matrix (FIM) from the given variational matrix,
that is, calculates minus the expectation of the second order derivative matrix of the log-likelihood
at the given times with respect to the model parameters.
The times are given in the variational matrix, which contains first and second order derivatives of
the output with respect to certain parameters, at certain times, for a particular individual.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">doCalcFim</span><span class="op">(</span><span class="va">df</span>, <span class="va">omega</span>, <span class="va">sigma</span>, <span class="va">vartheta</span>, <span class="va">varomega</span>, <span class="va">varsigma</span>, <span class="va">caller</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>df</dt>
<dd><p>Data frame of first and second order variations as generated by <code><a href="calcVariations.html">calcVariations</a></code>
or <code><a href="calcVariationsFim.html">calcVariationsFim</a></code>, that is, with columns 't', 'i', 'y', 'dy_d&lt;v1&gt;' and
'd2y_d&lt;v1&gt;_&lt;v2&gt;', where variables v1 and v2 are replaced by names.
This should not be normalized. If it is, it is denormalized.</p></dd>


<dt>omega</dt>
<dd><p>Symmetric, positive definite, numeric variance-covariance matrix of individual parameters.
Columns and rows should be named, and those names should be the same.</p></dd>


<dt>sigma</dt>
<dd><p>Symmetric, positive definite, numeric variance-covariance matrix of residual parameters.
Columns and rows should be named, and those names should be the same.</p></dd>


<dt>vartheta</dt>
<dd><p>Vector of names of population parameters for which derivatives are to be calculated.
Should be a subset of the names appearing in the variational matrix, or <code>NULL</code> for none.</p></dd>


<dt>varomega</dt>
<dd><p>Symmetric boolean matrix of the same dimension as <code>omega</code>, with the same row and
column names.
The value <code>TRUE</code> means the derivative of the corresponding element should be included in the FIM,
<code>FALSE</code> means not.</p></dd>


<dt>varsigma</dt>
<dd><p>Symmetric boolean matrix of the same dimension as <code>sigma</code>, with the same row and
column names.
The value <code>TRUE</code> means the derivative of the corresponding element should be included in the FIM,
<code>FALSE</code> means not.</p></dd>


<dt>caller</dt>
<dd><p>String containing the signature of the calling function, for use in error messages.
A typical value would be 'FisherInfo::calcFimFromMatrix'.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>The FIM, as a square matrix with element (i,j) equal to -E(d^2 L/d&lt;vi&gt;&lt;vj&gt;), where L is the
log likelihood and &lt;vi&gt; is the i-th parameter.
The row and column names of the matrix are those of the variable thetas, omegas and sigmas,
as specified by <code>vartheta</code>, <code>varomega</code> and <code>varsigma</code>.
The FIM is not normalized and the 'thetaNormalized', 'omegaNormalized' and 'sigmaNormalized' attributes
of this matrix are set to named vectors of <code>FALSE</code>, where the names are the names of the thetas,
and the column names of omegas and sigmas as specified by <code>df</code>, <code>omega</code> and <code>sigma</code>,
respectively.
The attributes 'theta', 'omega' and 'sigma' store the values of all parameters as named vectors.
They form a superset of the variable parameters.
The 'type' attribute is set to 'FIM'
The function displays an error and returns <code>NULL</code> if the input is incorrectly formatted or
the variance matrix cannot be inverted.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Martijn van Noort</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Martijn van Noort.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

