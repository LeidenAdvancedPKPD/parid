<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Calculate first and second order variations for FIM — calcVariationsFim • parid</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate first and second order variations for FIM — calcVariationsFim"><meta property="og:description" content="Calculates the variational matrix of the given model, that is, the first and second order derivatives of
the model outputs with respect to the model parameters, at given times.
This is tailored for use with the FIM methods.
Therefore derivatives of individual and residual error parameters are evaluated at 0, and so only their
names need to be provided as input."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">parid</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/parid.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate first and second order variations for FIM</h1>
    
    <div class="hidden name"><code>calcVariationsFim.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculates the variational matrix of the given model, that is, the first and second order derivatives of
the model outputs with respect to the model parameters, at given times.
This is tailored for use with the FIM methods.
Therefore derivatives of individual and residual error parameters are evaluated at 0, and so only their
names need to be provided as input.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calcVariationsFim</span><span class="op">(</span></span>
<span>  <span class="va">model</span>,</span>
<span>  <span class="va">p</span>,</span>
<span>  <span class="va">init</span>,</span>
<span>  <span class="va">output</span>,</span>
<span>  <span class="va">times</span>,</span>
<span>  <span class="va">theta</span>,</span>
<span>  <span class="va">nmeta</span>,</span>
<span>  <span class="va">nmeps</span>,</span>
<span>  vartheta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span>,</span>
<span>  vareta <span class="op">=</span> <span class="va">nmeta</span>,</span>
<span>  vareps <span class="op">=</span> <span class="va">nmeps</span>,</span>
<span>  symbolic <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  chkModel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>model</dt>
<dd><p>Function(t, y, p) of time, state variables and parameters, specifying the differential equations.
This function should return the numeric vector dy/dt.</p></dd>


<dt>p</dt>
<dd><p>Function(theta, eta) of population and individual parameters specifying the model parameters.
This function should return a named numeric vector.</p></dd>


<dt>init</dt>
<dd><p>Function(p) of parameters specifying the initial state (at time 0) of the model.</p></dd>


<dt>output</dt>
<dd><p>Function(y, p, eps) of state variables, parameters and residual errors specifying the model outputs.
This function should return a numeric vector.</p></dd>


<dt>times</dt>
<dd><p>Numeric vector of times where variations are to be evaluated.
Should all be &gt;= 0, but do not need to include the dose time 0.</p></dd>


<dt>theta</dt>
<dd><p>Population parameter values, as named numeric vector. May be <code>NULL</code> if none are needed.</p></dd>


<dt>nmeta</dt>
<dd><p>Names of individual parameters, as string vector. May be <code>NULL</code> if none are needed.</p></dd>


<dt>nmeps</dt>
<dd><p>Names of residual parameter values, as string vector. May be <code>NULL</code> if none are needed.</p></dd>


<dt>vartheta</dt>
<dd><p>Vector of names of population parameters for which variations are to be calculated.
Should be a subset of <code>names(theta)</code>, or <code>NULL</code> for none.
By default equal to <code>names(theta)</code>.</p></dd>


<dt>vareta</dt>
<dd><p>Vector of names of individual parameters for which variations are to be calculated.
Should be a subset of <code>nmeta</code>, or <code>NULL</code> for none.
By default equal to <code>nmeta</code>.</p></dd>


<dt>vareps</dt>
<dd><p>Vector of names of residual parameters for which variations are to be calculated.
Should be a subset of <code>nmeps</code>, or <code>NULL</code> for none.
By default equal to <code>nmeps</code>.</p></dd>


<dt>symbolic</dt>
<dd><p><code>TRUE</code> (default) if derivatives are to be computed symbolically, <code>FALSE</code> if numerically.
See <code><a href="calcVariations.html">calcVariations</a></code> for details.</p></dd>


<dt>chkModel</dt>
<dd><p><code>TRUE</code> (default) if it has to be checked whether model components (<code>model</code>, <code>p</code>, <code>init</code>, <code>output</code>)
are formatted correctly for symbolic manipulation, <code>FALSE</code> if not.</p></dd>


<dt>...</dt>
<dd><p>Named arguments to be passed to <code><a href="https://rdrr.io/pkg/deSolve/man/lsoda.html" class="external-link">lsoda</a></code>.
Can be used for example to pass events or error tolerances.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A data frame with columns 't' for time, 'i' for the index of the output element, 'y' for the outputs,
'dy/d&lt;v1&gt;' for the first derivatives and 'd2y/d&lt;v1&gt;_&lt;v2&gt;' for the second derivatives.
In the column names, variables v1 and v2 are replaced by the names in <code>vartheta</code>, <code>vareta</code> and <code>vareps</code>.
The data frame has an attribute 'theta' listing the values of <code>theta</code> as a named vector, and attributes
'eta' and 'eps' containing named vectors with 0 values for all parameters in <code>nmeta</code> and <code>nmeps</code>.
The 'type' attribute is set to 'VariationalMatrix', 'secOrd' to <code>TRUE</code> and 'symbolic' to the value of
<code>symbolic</code>.
The variational matrix is not normalized, as reflected in the attributes 'parameterNormalized' and 'outputNormalized',
that record input and output normalization, respectively.
The attribute 'parameterNormalized' is set to a named boolean vector of <code>FALSE</code>, with the theta, eta and eps
parameter names as names.
The attribute 'outputNormalized' is set to <code>FALSE</code>.
The function displays an error and returns <code>NULL</code> if <code>vartheta</code> contains elements not in <code>names(theta)</code>,
and likewise for <code>nmeta</code> and <code>nmeps</code>, or if <code>times</code> includes a negative value.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>The inputs <code>vareta</code> and <code>vareps</code> should contain all random parameters with nonzero variance, even if the
FIM calculation considers the variance and covariances of such a parameter as fixed (that is, derivatives with respect to
these variance and covariances do not appear in the FIM).
That is, random parameters may be dropped from <code>vareta</code> and <code>vareps</code> only if they have zero variance.
Notice that any variance and covariance parameters appearing in the FIM necessarily correspond to random parameters with
nonzero variance, so inclusion of all random parameters with nonzero variance is not only necessary but also sufficient.
That is, <code>vareta</code> and <code>vareps</code> can be set equal to the sets of all individual and residual parameters with
nonzero variance, respectively.</p>
<p>It is recommended to use symbolic derivation (<code>symbolic==TRUE</code>) rather than numerical derivation,
as it is more accurate, especially for derivatives that are formally zero.
See <code><a href="calcVariations.html">calcVariations</a></code> for details.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other calculation functions: 
<code><a href="calcAliasingScoresFromMatrix.html">calcAliasingScoresFromMatrix</a>()</code>,
<code><a href="calcAliasingScoresFromModel.html">calcAliasingScoresFromModel</a>()</code>,
<code><a href="calcFimFromMatrix.html">calcFimFromMatrix</a>()</code>,
<code><a href="calcFimFromModel.html">calcFimFromModel</a>()</code>,
<code><a href="calcFirstVariations.html">calcFirstVariations</a>()</code>,
<code><a href="calcSensitivityFromMatrix.html">calcSensitivityFromMatrix</a>()</code>,
<code><a href="calcSensitivityFromModel.html">calcSensitivityFromModel</a>()</code>,
<code><a href="calcVariations.html">calcVariations</a>()</code>,
<code><a href="fimIdent.html">fimIdent</a>()</code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Martijn van Noort</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Martijn van Noort.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

