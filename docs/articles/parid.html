<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title> â€¢ parid</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="">
<meta property="og:description" content="parid">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">parid</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/parid.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>parid</h1>
            
      
      
      <div class="hidden name"><code>parid.Rmd</code></div>

    </div>

    
    
<!-- # parid package: Calculation of parameter identifiability -->
<!-- #                indicators for nonlinear mixed effects models. -->
<!-- # -->
<!-- # Copyright (C) 2023 LAP&P Consultants BV -->
<!-- # Contact: info@lapp.nl -->
<!-- #          www.lapp.nl -->
<!-- #          Archimedesweg 31 -->
<!-- #          2333 CM Leiden, The Netherlands -->
<!-- #  -->
<!-- # This file is part of the parid package. -->
<!-- # The parid package is free software: you can redistribute it -->
<!-- # and/or modify it under the terms of the GNU General Public License as -->
<!-- # published by the Free Software Foundation, either version 3 of the -->
<!-- # License, or (at your option) any later version. -->
<!-- # -->
<!-- # The parid package is distributed in the hope that it will be -->
<!-- # useful, but WITHOUT ANY WARRANTY; without even the implied warranty -->
<!-- # of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the -->
<!-- # GNU General Public License for more details. -->
<!-- # -->
<!-- # You should have received a copy of the GNU General Public License -->
<!-- # along with the parid package. -->
<!-- # If not, see <https://www.gnu.org/licenses/>.  -->
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">parid</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: ggplot2</span></span>
<span><span class="co">#&gt; parid, version 1.0, (C) 2023 LAP&amp;P Consultants BV. See COPYING for license info</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This is an example showing how to use the parid package. The example
defines a nonlinear mixed effects model, and analyzes its parameter
identifiability using three methods:</p>
<ul>
<li>the Sensitivity Matrix Method (SMM)</li>
<li>the Fisher Information Matrix Method (FIMM)</li>
<li>the Aliasing Method</li>
</ul>
<p>This example assumes familiarity with mixed effects modeling. More
details on the methods and on parameter identifiability in general can
be found <a href="https://lapp.nl/lapp-software/parid.html" class="external-link">here</a>. R
code running this same example can be found in the package, at
tests/example.R.</p>
</div>
<div class="section level2">
<h2 id="model-definition">Model definition<a class="anchor" aria-label="anchor" href="#model-definition"></a>
</h2>
<p>The model is a one-compartmental linear PK model with absorption and
a single oral dose. The model parameters are clearance (CL), volume (V),
the absorption rate constant (Ka) and optionally the bio-availability
(F); they are defined in terms of underlying structural and
inter-individual parameters. In this example, inter-individual
variability is included on clearance. The output is the concentration,
which is modeled with an additive error.</p>
<p>The expected outcome is that this model will not be identifiable
because the bio-availability cannot be determined independently from the
clearance and volume. If the bio-availability is fixed, then the model
should be identifiable.</p>
<p>The next lines of code create four functions defining this model:</p>
<ul>
<li>
<code>model</code>: returns the differential equations describing
the time evolution of the model. The input arguments are the time
<code>t</code>, the current state <code>y</code> (i.e., the amounts in
the depot and central compartments), and the model parameters
<code>p</code>.</li>
<li>
<code>p</code>: returns the model parameters as function of the
structural parameters <code>theta</code> and inter-individual parameters
<code>eta</code>. The dose is also included here. In general, any
covariates could be included. For all parameters except CL, the value is
simply the value of the corresponding structural parameter.</li>
<li>
<code>init</code>: returns the initial values of the state
variables, as function of the model parameters <code>p</code>. In this
example, the depot is initialized to the bio-available fraction of the
dose, and the central compartment to zero.</li>
<li>
<code>output</code>: returns the model output, that is the
concentration (with residual error), as function of the state
<code>y</code>, the model parameters <code>p</code> and the residual
error <code>eps</code>.</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span>      <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">y</span>, <span class="va">p</span><span class="op">)</span> <span class="op">{</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">p</span><span class="op">[[</span><span class="st">"Ka"</span><span class="op">]</span><span class="op">]</span><span class="op">*</span><span class="va">y</span><span class="op">[[</span><span class="st">"x1"</span><span class="op">]</span><span class="op">]</span>, <span class="va">p</span><span class="op">[[</span><span class="st">"Ka"</span><span class="op">]</span><span class="op">]</span><span class="op">*</span><span class="va">y</span><span class="op">[[</span><span class="st">"x1"</span><span class="op">]</span><span class="op">]</span> <span class="op">-</span> <span class="va">p</span><span class="op">[[</span><span class="st">"CL"</span><span class="op">]</span><span class="op">]</span><span class="op">/</span><span class="va">p</span><span class="op">[[</span><span class="st">"V"</span><span class="op">]</span><span class="op">]</span> <span class="op">*</span> <span class="va">y</span><span class="op">[[</span><span class="st">"x2"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">}</span></span>
<span><span class="va">p</span>          <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">theta</span>, <span class="va">eta</span><span class="op">)</span> <span class="op">{</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Ka <span class="op">=</span> <span class="va">theta</span><span class="op">[[</span><span class="st">"TVKa"</span><span class="op">]</span><span class="op">]</span>, CL <span class="op">=</span> <span class="va">theta</span><span class="op">[[</span><span class="st">"TVCL"</span><span class="op">]</span><span class="op">]</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">eta</span><span class="op">[[</span><span class="st">"iCL"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                                       V <span class="op">=</span> <span class="va">theta</span><span class="op">[[</span><span class="st">"TVV"</span><span class="op">]</span><span class="op">]</span>, F <span class="op">=</span> <span class="va">theta</span><span class="op">[[</span><span class="st">"TVF"</span><span class="op">]</span><span class="op">]</span>, Dose <span class="op">=</span> <span class="va">theta</span><span class="op">[[</span><span class="st">"TVDose"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>  <span class="op">}</span></span>
<span><span class="va">init</span>       <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="op">{</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x1"</span> <span class="op">=</span> <span class="va">p</span><span class="op">[[</span><span class="st">"F"</span><span class="op">]</span><span class="op">]</span> <span class="op">*</span> <span class="va">p</span><span class="op">[[</span><span class="st">"Dose"</span><span class="op">]</span><span class="op">]</span>, <span class="st">"x2"</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">}</span></span>
<span><span class="va">output</span>     <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">y</span>, <span class="va">p</span>, <span class="va">eps</span><span class="op">)</span> <span class="op">{</span> <span class="va">y</span><span class="op">[[</span><span class="st">"x2"</span><span class="op">]</span><span class="op">]</span> <span class="op">/</span> <span class="va">p</span><span class="op">[[</span><span class="st">"V"</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="va">eps</span><span class="op">[[</span><span class="st">"addErr"</span><span class="op">]</span><span class="op">]</span> <span class="op">}</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="parameter-definition">Parameter definition<a class="anchor" aria-label="anchor" href="#parameter-definition"></a>
</h2>
<p>The next piece of code sets the values for the structural parameters
(<code>theta</code>). Some parameters can be considered as fixed. This
is typically done for covariates (in this example the dose). The vectors
<code>vartheta1</code> and <code>vartheta2</code> define two variants;
the first one also sets the bio-availability F as fixed, the second one
keeps it variable.</p>
<p>Variance matrices <code>omega</code> and <code>sigma</code> are
defined for the random variables <code>eta</code> and <code>eps</code>,
respectively. Their row and column names should be the same as the ones
used in the model definition. These matrices are the random-effects
parameters.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">theta</span>      <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TVKa"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"TVCL"</span> <span class="op">=</span> <span class="fl">0.2</span>, <span class="st">"TVV"</span> <span class="op">=</span> <span class="fl">2</span>, <span class="st">"TVF"</span> <span class="op">=</span> <span class="fl">0.7</span>, <span class="st">"TVDose"</span> <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">vartheta1</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TVDose"</span>, <span class="st">"TVF"</span><span class="op">)</span><span class="op">)</span>     <span class="co"># Bioavailability F is fixed</span></span>
<span><span class="va">vartheta2</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span>, <span class="st">"TVDose"</span><span class="op">)</span>               <span class="co"># Bioavailability F is variable</span></span>
<span><span class="va">omega</span>      <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">0.3</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">omega</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">omega</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"iCL"</span><span class="op">)</span></span>
<span><span class="va">sigma</span>      <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">0.1</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">sigma</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">sigma</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"addErr"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="sampling-times">Sampling times<a class="anchor" aria-label="anchor" href="#sampling-times"></a>
</h2>
<p>The vector <code>times</code> contains the sampling times. The
initialization (in this example, the time of dosing) is always set to
zero.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">times</span>      <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="variational-equations">Variational equations<a class="anchor" aria-label="anchor" href="#variational-equations"></a>
</h2>
<p>As a first step in the calculation, the variational equations are
solved. This is done two times, once for every setting of fixed
parameters as defined above, and will create data frames
<code>vareq1</code> and <code>vareq2</code> containing the derivatives
of the model output (the concentration) with respect to the structural
and random-effects parameters, evaluated at the sample times. The
derivatives are plotted over time. The plot functions have options
controlling which derivatives are plotted. See their documentation for
details.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vareq1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calcVariationsFim.html">calcVariationsFim</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">model</span>, p <span class="op">=</span> <span class="va">p</span>, init <span class="op">=</span> <span class="va">init</span>, output <span class="op">=</span> <span class="va">output</span>, times <span class="op">=</span> <span class="va">times</span>, symbolic <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                           theta <span class="op">=</span> <span class="va">theta</span>, nmeta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">omega</span><span class="op">)</span>, nmeps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">sigma</span><span class="op">)</span>, vartheta <span class="op">=</span> <span class="va">vartheta1</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotVariations.html">plotVariations</a></span><span class="op">(</span><span class="va">vareq1</span><span class="op">)</span></span></code></pre></div>
<p><img src="parid_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vareq2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calcVariationsFim.html">calcVariationsFim</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">model</span>, p <span class="op">=</span> <span class="va">p</span>, init <span class="op">=</span> <span class="va">init</span>, output <span class="op">=</span> <span class="va">output</span>, times <span class="op">=</span> <span class="va">times</span>, symbolic <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                            theta <span class="op">=</span> <span class="va">theta</span>, nmeta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">omega</span><span class="op">)</span>, nmeps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">sigma</span><span class="op">)</span>, vartheta <span class="op">=</span> <span class="va">vartheta2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotVariations.html">plotVariations</a></span><span class="op">(</span><span class="va">vareq2</span><span class="op">)</span></span></code></pre></div>
<p><img src="parid_files/figure-html/unnamed-chunk-5-2.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="compute-and-plot-sensitivity-matrix-method-smm-results">Compute and plot Sensitivity Matrix Method (SMM) results<a class="anchor" aria-label="anchor" href="#compute-and-plot-sensitivity-matrix-method-smm-results"></a>
</h2>
<p>SMM results are generated from the variational matrices
<code>vareq1</code> and <code>vareq2</code> using the function
<code>calcSensitivityFromMatrix</code>. The <code>outputs</code>
argument controls which SMM indicators are computed. They are (<a href="https://lapp.nl/lapp-software/parid.html" class="external-link">more details</a>):</p>
<ul>
<li>The null space dimension <code>N</code>. This is a categorical
indicator, equal to the number of unidentifiable directions. So 0 means
identifiable, and larger than 0 means unidentifiable.</li>
<li>The skewing angle <code>A</code>. This is a continuous indicator,
taking values between 0 and 1, where 0 means unidentifiable, 1 means
identifiable. If <code>A</code> is close to 0 then the model is close to
unidentifiable.</li>
<li>The unidentifiable directions <code>R</code>. This lists the
parameter directions in which the model is unidentifiable. The number of
directions equals <code>N</code>.</li>
<li>The minimal parameter relations <code>M</code> and the M-norm given
by its <code>norm</code> attribute. The M-norm is a continuous
indicator, taking values between 0 and 1, where 0 means unidentifiable,
1 means identifiable. If the M-norm is close to 0 then the model is
close to unidentifiable. For small M-norms, the vector <code>M</code>
contains the parameter direction in which the model is
unidentifiable.</li>
<li>The least identifiable parameter norms (L-norms) <code>L</code>.
This is a vector of continuous indicators, one for each parameter,
taking values between 0 and 1, where 0 means unidentifiable, 1 means
identifiable. If a component of <code>L</code> is close to 0 then that
parameter is close to unidentifiable.</li>
</ul>
<p>The results are displayed and graphed. The first variant, where the
bio-availability F was fixed, is identifiable, as can be seen from the
output of <code>simplifySensitivities(sens1)</code>: the null space
dimension <code>N</code> is 0, and the skewing angle, M-norm and L-norms
are all large.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sens1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calcSensitivityFromMatrix.html">calcSensitivityFromMatrix</a></span><span class="op">(</span>outputs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"N"</span>, <span class="st">"A"</span>, <span class="st">"R"</span>, <span class="st">"M"</span>, <span class="st">"L"</span><span class="op">)</span>, df <span class="op">=</span> <span class="va">vareq1</span>, vars <span class="op">=</span> <span class="va">vartheta1</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/simplifySensitivities.html">simplifySensitivities</a></span><span class="op">(</span><span class="va">sens1</span><span class="op">)</span></span>
<span><span class="co">#&gt; $N</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $A</span></span>
<span><span class="co">#&gt; [1] 0.6668127</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $R</span></span>
<span><span class="co">#&gt;     </span></span>
<span><span class="co">#&gt; TVKa</span></span>
<span><span class="co">#&gt; TVCL</span></span>
<span><span class="co">#&gt; TVV </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $M</span></span>
<span><span class="co">#&gt;             [,1]</span></span>
<span><span class="co">#&gt; TVKa  0.75420019</span></span>
<span><span class="co">#&gt; TVCL -0.07767148</span></span>
<span><span class="co">#&gt; TVV   0.65203467</span></span>
<span><span class="co">#&gt; attr(,"norm")</span></span>
<span><span class="co">#&gt; [1] 0.1814101</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $L</span></span>
<span><span class="co">#&gt;       TVV      TVCL      TVKa </span></span>
<span><span class="co">#&gt; 0.4485372 0.5462389 0.5542248</span></span>
<span><span class="va">plsens1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotSensitivities.html">plotSensitivities</a></span><span class="op">(</span><span class="va">sens1</span><span class="op">)</span></span>
<span><span class="va">plsens1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">plsens1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lengths.html" class="external-link">lengths</a></span><span class="op">(</span><span class="va">plsens1</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">]</span>, <span class="kw">function</span><span class="op">(</span><span class="va">pl</span><span class="op">)</span> <span class="va">pl</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span>plotlist <span class="op">=</span> <span class="va">plsens1</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="parid_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>The second variant, where F was variable, is not identifiable, see
the output of <code>simplifySensitivities(sens2)</code>: the null space
dimension is 1, and the skewing angle, M-norm and L-norms are all small
or even zero. The indicators <code>R</code> and <code>M</code> find a
relation involving F, CL and V, as expected.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sens2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calcSensitivityFromMatrix.html">calcSensitivityFromMatrix</a></span><span class="op">(</span>outputs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"N"</span>, <span class="st">"A"</span>, <span class="st">"R"</span>, <span class="st">"M"</span>, <span class="st">"L"</span><span class="op">)</span>, df <span class="op">=</span> <span class="va">vareq2</span>, vars <span class="op">=</span> <span class="va">vartheta2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/simplifySensitivities.html">simplifySensitivities</a></span><span class="op">(</span><span class="va">sens2</span><span class="op">)</span></span>
<span><span class="co">#&gt; $N</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $A</span></span>
<span><span class="co">#&gt; [1] 0.002006091</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $R</span></span>
<span><span class="co">#&gt;           [,1]</span></span>
<span><span class="co">#&gt; TVKa 0.0000000</span></span>
<span><span class="co">#&gt; TVCL 0.0939682</span></span>
<span><span class="co">#&gt; TVV  0.9396820</span></span>
<span><span class="co">#&gt; TVF  0.3288887</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $M</span></span>
<span><span class="co">#&gt;           [,1]</span></span>
<span><span class="co">#&gt; TVKa 0.0000000</span></span>
<span><span class="co">#&gt; TVCL 0.0939682</span></span>
<span><span class="co">#&gt; TVV  0.9396820</span></span>
<span><span class="co">#&gt; TVF  0.3288887</span></span>
<span><span class="co">#&gt; attr(,"norm")</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $L</span></span>
<span><span class="co">#&gt;       TVF       TVV      TVCL      TVKa </span></span>
<span><span class="co">#&gt; 0.0000000 0.0000000 0.0000000 0.5542248</span></span>
<span><span class="va">plsens2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotSensitivities.html">plotSensitivities</a></span><span class="op">(</span><span class="va">sens2</span><span class="op">)</span></span>
<span><span class="va">plsens2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">plsens2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lengths.html" class="external-link">lengths</a></span><span class="op">(</span><span class="va">plsens2</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">]</span>, <span class="kw">function</span><span class="op">(</span><span class="va">pl</span><span class="op">)</span> <span class="va">pl</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span>plotlist <span class="op">=</span> <span class="va">plsens2</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="parid_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="compute-and-plot-aliasing-method-results">Compute and plot Aliasing Method results<a class="anchor" aria-label="anchor" href="#compute-and-plot-aliasing-method-results"></a>
</h2>
<p>The results are generated from the variational matrices
<code>vareq1</code> and <code>vareq2</code> using the function
<code>calcAliasingFromMatrix</code>. The results are displayed and
graphed. Both variants are identifiable, as aliasing scores are quite
low. This is because the aliasing method can only find identifiability
problems involving two parameters, and not three.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alia1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calcAliasingScoresFromMatrix.html">calcAliasingScoresFromMatrix</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">vareq1</span>, vars <span class="op">=</span> <span class="va">vartheta1</span><span class="op">)</span></span>
<span><span class="va">plalia1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotAliasing.html">plotAliasing</a></span><span class="op">(</span><span class="va">alia1</span>, elt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"S"</span>, <span class="st">"T"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span>plotlist <span class="op">=</span> <span class="va">plalia1</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="parid_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">alia2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calcAliasingScoresFromMatrix.html">calcAliasingScoresFromMatrix</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">vareq2</span>, vars <span class="op">=</span> <span class="va">vartheta2</span><span class="op">)</span></span>
<span><span class="va">plalia2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotAliasing.html">plotAliasing</a></span><span class="op">(</span><span class="va">alia2</span>, elt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"S"</span>, <span class="st">"T"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span>plotlist <span class="op">=</span> <span class="va">plalia2</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="parid_files/figure-html/unnamed-chunk-8-2.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="compute-and-plot-fisher-information-matrix-method-fimm-results">Compute and plot Fisher Information Matrix Method (FIMM)
results<a class="anchor" aria-label="anchor" href="#compute-and-plot-fisher-information-matrix-method-fimm-results"></a>
</h2>
<p>FIMM results are generated from the variational matrices
<code>vareq1</code> and <code>vareq2</code> using the functions
<code>calcFimFromMatrix</code> and <code>fimIdent</code>, that compute
the Fisher Information Matrix (FIM) and the parameter identifiability
indicators, respectively. The indicators are (<a href="https://lapp.nl/lapp-software/parid.html" class="external-link">more details</a>):</p>
<ul>
<li>Categorical identifiability <code>identifiable</code>. This is
<code>TRUE</code> if all curvatures are 0 and the model is identifiable,
and <code>FALSE</code> if there are positive curvatures and the model is
unidentifiable. The curvatures describe the objective function value
(OFV) surface as function of the parameters.</li>
<li>The number of 0 curvatures <code>nDirections</code>. This is a
categorical indicator counting the number of 0 curvatures.</li>
<li>The parameter vectors <code>directions</code> corresponding to the
curvatures, in order of increasing curvature. For zero (or small)
curvatures, they indicate the directions in parameter space of (near)
unidentifiability.</li>
<li>The curvature values <code>curvatures</code> of the OFV surface.
Zero values correspond to unidentifiability, small values indicate near
unidentifiability.</li>
<li>The index <code>jump</code> of the highest change in curvature
value.</li>
<li>The estimated standard error <code>se</code>, calculated from the
FIM.</li>
<li>The estimated relative standard error <code>rse</code>, calculated
from the FIM.</li>
</ul>
<p>The results are displayed. The first variant, where the
bio-availability F was fixed, is identifiable: all curvatures are high.
The options <code>relChanges = TRUE</code> and <code>ci = 0.95</code>
imply that the <code>directions</code> show the relative percentage
changes corresponding to an insignificant increase (at 95%) in objective
function of at most 3.84, for the given number of subjects. They are all
below 50%.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fim1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calcFimFromMatrix.html">calcFimFromMatrix</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">vareq1</span>, omega <span class="op">=</span> <span class="va">omega</span>, sigma <span class="op">=</span> <span class="va">sigma</span>, vartheta <span class="op">=</span> <span class="va">vartheta1</span><span class="op">)</span></span>
<span><span class="va">fimres1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fimIdent.html">fimIdent</a></span><span class="op">(</span>fim <span class="op">=</span> <span class="va">fim1</span>, curvature <span class="op">=</span> <span class="fl">1e-10</span>, relChanges <span class="op">=</span> <span class="cn">TRUE</span>, ci <span class="op">=</span> <span class="fl">0.95</span>, nsubj <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/simplifyFimIdent.html">simplifyFimIdent</a></span><span class="op">(</span><span class="va">fimres1</span><span class="op">)</span></span>
<span><span class="co">#&gt; $identifiable</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $nDirections</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $directions</span></span>
<span><span class="co">#&gt;              [,1]       [,2]       [,3]         [,4]     [,5]</span></span>
<span><span class="co">#&gt; TVKa    9.9061084 -8.6678631 -2.9435682  -0.12214659  0.00000</span></span>
<span><span class="co">#&gt; TVCL   -6.0881243 -0.3264183  0.1793294 -16.80599830  0.00000</span></span>
<span><span class="co">#&gt; TVV     4.0494263 -3.0153337  1.9606156  -0.03457756  0.00000</span></span>
<span><span class="co">#&gt; iCL    45.2711270 33.0420632 -0.6269551  -0.57003282  0.00000</span></span>
<span><span class="co">#&gt; addErr -0.1127873 -0.1378980  0.0251975   0.05610669 16.00194</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $curvatures</span></span>
<span><span class="co">#&gt; [1]   109.8634   183.1313  1595.4680  3385.5471 15002.0161</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $jump</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $se</span></span>
<span><span class="co">#&gt;       TVKa       TVCL        TVV        iCL     addErr </span></span>
<span><span class="co">#&gt; 0.37694626 0.09992565 0.30271768 0.46993184 0.04472136 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $rse</span></span>
<span><span class="co">#&gt;      TVKa      TVCL       TVV       iCL    addErr </span></span>
<span><span class="co">#&gt;  37.69463  49.96282  15.13588 156.64395  44.72136</span></span></code></pre></div>
<p>The second variant, where F was variable, is not identifiable, as the
first curvature is close to zero. It finds a relation involving F, CL
and V in <code>directions</code>, as expected. The relative changes are
very large, indicating that the parameters can change by a large factor
without significantly changing the OFV.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fim2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calcFimFromMatrix.html">calcFimFromMatrix</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">vareq2</span>, omega <span class="op">=</span> <span class="va">omega</span>, sigma <span class="op">=</span> <span class="va">sigma</span>, vartheta <span class="op">=</span> <span class="va">vartheta2</span><span class="op">)</span></span>
<span><span class="va">fimres2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fimIdent.html">fimIdent</a></span><span class="op">(</span>fim <span class="op">=</span> <span class="va">fim2</span>, curvature <span class="op">=</span> <span class="fl">1e-10</span>, relChanges <span class="op">=</span> <span class="cn">TRUE</span>, ci <span class="op">=</span> <span class="fl">0.95</span>, nsubj <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in FisherInfo::fimIdent: SE's and RSE's cannot be calculated because FIM cannot be inverted. I will set them to NA, and continue without them.</span></span>
<span><span class="fu"><a href="../reference/simplifyFimIdent.html">simplifyFimIdent</a></span><span class="op">(</span><span class="va">fimres2</span><span class="op">)</span></span>
<span><span class="co">#&gt; $identifiable</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $nDirections</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $directions</span></span>
<span><span class="co">#&gt;             [,1]       [,2]         [,3]         [,4]        [,5]      [,6]</span></span>
<span><span class="co">#&gt; TVKa           0  7.0481967  11.48509526  -0.47008081 -0.36997026   0.00000</span></span>
<span><span class="co">#&gt; TVCL   -70517721 -8.4600755  -4.92646955 -16.70180859  1.37943161   0.00000</span></span>
<span><span class="co">#&gt; TVV    -70517721  0.3837179   0.44188540   0.21666273  0.28984508   0.00000</span></span>
<span><span class="co">#&gt; TVF    -70517721 -2.4417729  -3.20506697  -0.40526242 -2.47868897   0.00000</span></span>
<span><span class="co">#&gt; iCL            0 52.9879893 -18.27022014  -0.66179776 -0.07046264   0.00000</span></span>
<span><span class="co">#&gt; addErr         0 -0.1496521   0.09507588   0.06271155  0.06099013 -16.00182</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $curvatures</span></span>
<span><span class="co">#&gt; [1] 1.705303e-12 1.244213e+02 2.276623e+02 3.287036e+03 1.079053e+04</span></span>
<span><span class="co">#&gt; [6] 1.500206e+04</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $jump</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $se</span></span>
<span><span class="co">#&gt;   TVKa   TVCL    TVV    TVF    iCL addErr </span></span>
<span><span class="co">#&gt;     NA     NA     NA     NA     NA     NA </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $rse</span></span>
<span><span class="co">#&gt;   TVKa   TVCL    TVV    TVF    iCL addErr </span></span>
<span><span class="co">#&gt;     NA     NA     NA     NA     NA     NA</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Martijn van Noort.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
